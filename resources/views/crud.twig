{% extends 'template/app.twig' %}
{% block title %}CRUDpage{% endblock %}

{% block content %}

{% include 'partials/flash.twig' %}
<h2>Insert message into DB <small>(should be signed in area)</small></h2>
<p>The name should ofc be the name the user signed up with.</p>

<form method="POST" action="{{ path_for('new') }}">
	<label>Name</label>
	{# name ofc should be the signed-in user #}
		{% if errors.namn %}
    	    <span class="help-block" style="color:#f20000">{{ errors.namn | first }}</span><br>
    	{% endif %}<br>
	<input type="text" name="namn" placeholder="name" value="{{ old.namn }}" autocomplete="off"><br>

	<label>Text</label>
		{% if errors.text %}
    	    <span class="help-block" style="color:#f20000">{{ errors.text | first }}</span><br>
    	{% endif %}<br>
	<textarea name="text" placeholder="text" rows="5" cols="50">{{ old.text }}</textarea><br>
	<input type="submit" value="Send">
</form>
  
<div>
{% if querys %}
	{% for query in querys %}
		<hr>
		<div>ID#: {{ query.note_id }}, Name: {{ query.user_namn }}, Time: {{ diffForHumans(query.created_at) }}{% if query.updated_at %}, Edit: {{ diffForHumans(query.updated_at) }} {% endif %}</div>
		<div>Content: {{ query.text }}</div>
		<div>
			<a href="{{ path_for('delete', {id: query.note_id}) }}">delete</a> - 
			<a href="{{ path_for('view', {id: query.note_id}) }}">edit</a>
		</div>
	{% endfor %}
{% endif %}

{% if querys is empty %}
	<h1>much empty db</h1>
{% endif %}
</div>

{% endblock %}